//code to generate and feed ecg signal samples time stretched by a period suitable for the balloon
short int arr[]={101,100,100,99,99,98,97,96,93,95,95,96,97,95,95,95,94,94,93,97,96,94,95,94,94,95,95,96,95,96,94,95,95,95,95,94,95,95,93,94,94,95,96,95,95,95,93,94,95,96,95,96,96,96,97,96,96,95,95,95,94,94,93,95,100,101,106,108,100,98,93,95,97,95,96,95,95,96,96,97,96,95,97,96,98,96,98,99,98,100,100,100,99,98,100,100,100,99,97,96,94,94,95,96,95,95,95,95,93,94,94,96,96,94,94,95,96,96,95,97,95,94,95,94,96,96,95,95,95,95,95,94,95,94,95,95,94,95,94,94,96,96,98,96,94,95,97,98,96,97,97,95,95,93,95,95,95,95,97,101,104,108,104,99,95,95,96,96,95,97,95,95,96,96,97,96,96,98,96,97,97,98,99,98,100,100,100,101,100,101,99,97,99,97,97,96,95,96,95,95,94,95,95,94,96,94,95,96,94,96,95,94,96,95,96,96,95,97,97,96,96,95,96,95,96,95,96,97,95,94,94,95,97,96,96,95,95,95,94,95,97,95,95,97,96,96,98,98,96,95,94,95,95,95,94,95,98,103,104,108,105,100,96,95,97,96,94,95,95,95,96,96,97,96,96,96,97,98,97,98,98,98,99,99,100,102,101,100,98,98,97,96,97,94,96,96,94,95,94,95,95,94,95,94,93,94,94,95,95,95,95,95,96,95,95,96,96,95,93,94,95,94,96,94,95,95,95,95,94,95,94,94,95,94,95,95,94,95,95,98,99,96,97,96,95,94,95,96,94,95,94,96,100,101,109,108,101,96,94,97,96,95,98,96,96,97,95,96,95,97,97,96,97,98,99,99,100,102,98,100,99,99,100,99,99,98,98,97,95,96,95,95,96,95,96,95,92,94,93,96,96,95,96,95,95,94,96,97,95,97,95,94,96,94,96,96,95,95,95,95,94,95,97,95,97,96,92,95,95,96,97,96,98,98,98,95,95,95,95,95,96,95,95,98,102,108,108,101,97,94};

short int i;

short int peak1cnt,peak2cnt,peak1index;


void setup() {
  
  
  pinMode(8, OUTPUT);//pin for the air pump
  pinMode(9,OUTPUT);//pin for vacuum pump
  Serial.begin(9600);
}


void loop() {
  
  while(1)
  {peak1cnt=peak2cnt=0;
  for(i=0;i<450;i++)
  {Serial.print(i);
  Serial.println("air pump on");
    digitalWrite(8,HIGH);
    digitalWrite(9,LOW);
    //Serial.println(arr[i]);
  if(arr[i]>106)
  {peak1cnt++;
  
    if(peak1cnt==1)//1st r
  {
  digitalWrite(8,LOW);
  digitalWrite(9,HIGH);
  Serial.print(i);
  Serial.println("vaccuum pump on");
   delay(9);
  }

  else if (peak1cnt==2) peak1index=i;
  }

  else if((arr[i]>98)&&(arr[i]<102)&&((i-peak1index)>19)&&(peak1cnt==2))
  {peak2cnt++;
  if(peak2cnt==3)//3rd t 
  {Serial.print(i);
  Serial.println("air pump on");
     digitalWrite(8,HIGH);
      digitalWrite(9,LOW);
      delay(9);
  }
    
 
  
  }

    
    
  }
   
   

  }
  
}
